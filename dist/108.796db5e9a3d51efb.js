"use strict";(self.webpackChunksmarthome=self.webpackChunksmarthome||[]).push([[108],{6108:(w,g,o)=>{o.r(g),o.d(g,{LoginModule:()=>C});var l=o(4258),m=o(9609),r=o(4006);class d{constructor(a,t,i,s,u,c){this.id=a,this.token=t,this.createdBy=i,this.createdDate=s,this.lastModifiedBy=u,this.lastModifiedDate=c}}var e=o(4650),h=o(9199),f=o(6091),v=o(5219),p=o(529),U=o(1082);let Z=(()=>{class n{constructor(t,i){this.http=t,this.applicationConfigService=i,this.resourceUrl=this.applicationConfigService.getEndpointFor("api/device-token")}create(t){return this.http.post(this.resourceUrl,t)}}return n.\u0275fac=function(t){return new(t||n)(e.LFG(p.eN),e.LFG(U.y))},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();var T=o(6895),y=o(1995),b=o(6188);const A=["username"];function S(n,a){1&n&&(e.TgZ(0,"div",21),e._uU(1,"\n        "),e.TgZ(2,"strong"),e._uU(3,"Failed to sign in!"),e.qZA(),e._uU(4," Please check your credentials and try again.\n      "),e.qZA())}const L={path:"",component:(()=>{class n{constructor(t,i,s,u,c){this.accountService=t,this.loginService=i,this.router=s,this.localStorageService=u,this.deviceTokenService=c,this.authenticationError=!1,this.loginForm=new r.cw({username:new r.NI("",{nonNullable:!0,validators:[r.kI.required]}),password:new r.NI("",{nonNullable:!0,validators:[r.kI.required]}),rememberMe:new r.NI(!1,{nonNullable:!0,validators:[r.kI.required]})})}ngOnInit(){this.accountService.identity().subscribe(()=>{this.accountService.isAuthenticated()&&this.router.navigate([""])})}ngAfterViewInit(){this.username.nativeElement.focus()}login(){const t=this.localStorageService.retrieve("deviceToken");this.loginService.login(this.loginForm.getRawValue()).subscribe({next:()=>{const i=new d(null,t);this.deviceTokenService.create(i).subscribe({next:()=>{console.log("save success")}}),this.authenticationError=!1,this.router.getCurrentNavigation()||this.router.navigate([""])},error:()=>this.authenticationError=!0})}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(h.B),e.Y36(f.r),e.Y36(l.F0),e.Y36(v.n2),e.Y36(Z))},n.\u0275cmp=e.Xpm({type:n,selectors:[["jhi-login"]],viewQuery:function(t,i){if(1&t&&e.Gf(A,5),2&t){let s;e.iGM(s=e.CRH())&&(i.username=s.first)}},decls:65,vars:8,consts:[[1,"d-flex","justify-content-center"],[1,"col-lg-6","col-md-8","col-sm-10"],["jhiTranslate","login.title","data-cy","loginTitle"],["class","alert alert-danger","jhiTranslate","login.messages.error.authentication","data-cy","loginError",4,"ngIf"],["role","form",1,"form",3,"formGroup","ngSubmit"],[1,"mb-3"],["for","username","jhiTranslate","global.form.username.label",1,"username-label"],["type","text","name","username","id","username","formControlName","username","data-cy","username",1,"form-control",3,"placeholder"],["username",""],["for","password","jhiTranslate","login.form.password"],["type","password","name","password","id","password","formControlName","password","data-cy","password",1,"form-control",3,"placeholder"],[1,"form-check"],["for","rememberMe",1,"form-check-label"],["type","checkbox","name","rememberMe","id","rememberMe","formControlName","rememberMe",1,"form-check-input"],["jhiTranslate","login.form.rememberme"],["type","submit","jhiTranslate","login.form.button","data-cy","submit",1,"btn","btn-primary"],[1,"mt-3","alert","alert-warning"],["routerLink","/account/reset/request","jhiTranslate","login.password.forgot","data-cy","forgetYourPasswordSelector",1,"alert-link"],[1,"alert","alert-warning"],["jhiTranslate","global.messages.info.register.noaccount"],["routerLink","/account/register","jhiTranslate","global.messages.info.register.link",1,"alert-link"],["jhiTranslate","login.messages.error.authentication","data-cy","loginError",1,"alert","alert-danger"]],template:function(t,i){1&t&&(e.TgZ(0,"div"),e._uU(1,"\n  "),e.TgZ(2,"div",0),e._uU(3,"\n    "),e.TgZ(4,"div",1),e._uU(5,"\n      "),e.TgZ(6,"h1",2),e._uU(7,"Sign in"),e.qZA(),e._uU(8,"\n      "),e.YNc(9,S,5,0,"div",3),e._uU(10,"\n      "),e.TgZ(11,"form",4),e.NdJ("ngSubmit",function(){return i.login()}),e._uU(12,"\n        "),e.TgZ(13,"div",5),e._uU(14,"\n          "),e.TgZ(15,"label",6),e._uU(16,"Username"),e.qZA(),e._uU(17,"\n          "),e._UZ(18,"input",7,8),e.ALo(20,"translate"),e._uU(21,"\n        "),e.qZA(),e._uU(22,"\n\n        "),e.TgZ(23,"div",5),e._uU(24,"\n          "),e.TgZ(25,"label",9),e._uU(26,"Password"),e.qZA(),e._uU(27,"\n          "),e._UZ(28,"input",10),e.ALo(29,"translate"),e._uU(30,"\n        "),e.qZA(),e._uU(31,"\n\n        "),e.TgZ(32,"div",11),e._uU(33,"\n          "),e.TgZ(34,"label",12),e._uU(35,"\n            "),e._UZ(36,"input",13),e._uU(37,"\n            "),e.TgZ(38,"span",14),e._uU(39,"Remember me"),e.qZA(),e._uU(40,"\n          "),e.qZA(),e._uU(41,"\n        "),e.qZA(),e._uU(42,"\n\n        "),e.TgZ(43,"button",15),e._uU(44,"Sign in"),e.qZA(),e._uU(45,"\n      "),e.qZA(),e._uU(46,"\n      "),e.TgZ(47,"div",16),e._uU(48,"\n        "),e.TgZ(49,"a",17),e._uU(50,"Did you forget your password?"),e.qZA(),e._uU(51,"\n      "),e.qZA(),e._uU(52,"\n\n      "),e.TgZ(53,"div",18),e._uU(54,"\n        "),e.TgZ(55,"span",19),e._uU(56,"You don't have an account yet?"),e.qZA(),e._uU(57,"\n        "),e.TgZ(58,"a",20),e._uU(59,"Register a new account"),e.qZA(),e._uU(60,"\n      "),e.qZA(),e._uU(61,"\n    "),e.qZA(),e._uU(62,"\n  "),e.qZA(),e._uU(63,"\n"),e.qZA(),e._uU(64,"\n")),2&t&&(e.xp6(9),e.Q6J("ngIf",i.authenticationError),e.xp6(2),e.Q6J("formGroup",i.loginForm),e.xp6(7),e.s9C("placeholder",e.lcZ(20,4,"global.form.username.placeholder")),e.xp6(10),e.s9C("placeholder",e.lcZ(29,6,"login.form.password.placeholder")))},dependencies:[r._Y,r.Fj,r.Wl,r.JJ,r.JL,T.O5,r.sg,r.u,y.P,l.yS,b.X$],encapsulation:2}),n})(),data:{pageTitle:"login.title"}};let C=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[m.m,l.Bz.forChild([L])]}),n})()}}]);